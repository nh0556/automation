---
# tasks file for test_juniper_config
#
- name: convert enable_debug to boolean
  set_fact:
    enable_debug: "{{ enable_debug | bool }}"

- name: convert apply_config to boolean
  set_fact:
    apply_config: "{{ apply_config | bool }}"

- name: get device facts
  juniper_junos_facts:
    host: "{{ host_ip }}"
    savedir: "{{ playbook_dir }}"

- name: print junos version
  debug:
    var: junos.version
  when: enable_debug

- name: dump apply_config
  debug:
    var: apply_config
  when: enable_debug

- name: test config preview
  juniper_junos_config:
    host: "{{ ansible_host }}"
    port: "{{ ansible_port }}"
    load: "set"
    diff: true
    commit: "{{ apply_config }}" 
    # retrieve: candidate
    return_output: true
    lines:
      - 'set interfaces ge-0/0/4 unit 0 description "hello world again"'
  register: response

- name: dump config preview response
  debug:
    # var: response.diff_lines
    var: response
